(()=>{"use strict";var t,e={5012:(t,e,r)=>{var s=r(6540),o=r(5338),i=r(4682),l=r(6801);let n="#161b22",a="#faa356",h="#a2d2fb",c="#ecf2f8",d="#7ce38b",u="#cea5fb";var p=r(9980);class f{constructor(t){this.lut=[...t],this.invLut=Array(t.length);for(let e=0;e<t.length;e++)this.invLut[t[e]]=e}invert(){let t=this.invLut;this.invLut=this.lut,this.lut=t}}var x=r(4848);class b{constructor(t,e,r,s){this.top=e,this.bottom=s,this.left=t,this.right=r}pad(t){this.left-=t,this.top-=t,this.right+=t,this.bottom+=t}scale(t,e){this.right=t(this.right),this.left=t(this.left),this.top=e(this.top),this.bottom=e(this.bottom)}width(){return this.right-this.left}height(){return this.bottom-this.top}}class m{constructor(t,e,r,s){this.order=t,this.width=2*t,this.height=2**t,this.left=e,this.top=r,this.id=s}isInput(t){return 0==t}isOutput(t){return t==this.width-1}isSubOutput(t){return t>=this.width/2}isTerminal(t){return this.isOutput(t)||this.isInput(t)}globalX(t){return this.left+t}globalY(t){return this.top+t}topSubnet(){return new m(this.order-1,this.globalX(1),this.globalY(0),this.id+"0")}bottomSubnet(){return new m(this.order-1,this.globalX(1),this.globalY(this.height/2),this.id+"1")}extent(){return new b(this.globalX(0),this.globalY(0),this.globalX(this.width-1),this.globalY(this.height-1))}}class g{constructor(t,e,r){this.rootSubnet=new m(t,0,0,"");let s=this.rootSubnet.extent();this.vertical=e;let[o,i]=this.verticalitySwap([s.left,s.right],[s.top,s.bottom]);this.xScale=l.m4Y(o,[r.left,r.right]),this.yScale=l.m4Y(i,[r.top,r.bottom])}verticalitySwap(t,e){return this.vertical?[e,t]:[t,e]}toScreen(t,e){let[r,s]=this.verticalitySwap(t,e);return[this.xScale(r),this.yScale(s)]}toScreenBox(t){let e=new b(0,0,0,0);return[e.left,e.top]=this.toScreen(t.left,t.top),[e.right,e.bottom]=this.toScreen(t.right,t.bottom),e}yFromScreen(t,e){let r=this.vertical?this.xScale.invert(t):this.yScale.invert(e);return r=Math.min(this.rootSubnet.height-1,Math.max(0,Math.round(r))),r}}function v(t,e){let r=2**(t-1),s=e;return e>=r?s-=r:s+=r,s}var j=function(t){return t[t.Top=0]="Top",t[t.Bottom=1]="Bottom",t[t.None=2]="None",t}(j||{});function y(t,e){if(1===t)return 0===e.lut[0]?[{edgeColors:[j.None],verts:[0,0]},{edgeColors:[j.None],verts:[1,1]}]:[{edgeColors:[j.None],verts:[0,1]},{edgeColors:[j.None],verts:[1,0]}];let r=2**t,s=Array(r),o=new Set(Array(r).keys());for(;o.size>0;){let r=-1;for(let t of o){r=t;break}if(r<0)break;let i=[];for(o.delete(r),i.push(r),s[r]={edgeColors:[j.Top],verts:[r]};;){let r=i.shift();if(void 0===r)break;let l=1-s[r].edgeColors[0],n=v(t,r),a=e.invLut[v(t,e.lut[r])];for(let t of[n,a])o.has(t)&&(o.delete(t),s[t]={edgeColors:[l],verts:[t]},i.push(t))}}let i=[Array(r/2),Array(r/2)];for(let t=0;t<r;t++){let o=t%(r/2);i[s[t].edgeColors[0]][o]=e.lut[t]%(r/2)}let l=i.map((e=>y(t-1,new f(e))));for(let t=0;t<r;t++){let e=t%(r/2),o=s[t],i=o.edgeColors[0],n=i*r/2;o.edgeColors.push(...l[i][e].edgeColors),o.verts.push(...l[i][e].verts.map((t=>t+n)))}for(let t=0;t<r;t++){let r=s[t];r.edgeColors.push(r.edgeColors[0]),r.verts.push(e.lut[t])}return s}function S(t){let{order:e,vertical:r=!0,doRouting:o=!0,bipartiteColors:m=!1,drawBoxes:v=!0,dottedLines:S=!1}=t,w=2**e,N=(0,s.useRef)(null),[k,_]=(0,s.useState)(),[C,O]=(0,s.useState)(new f([...Array(w).keys()])),[I,B]=(0,s.useState)(-1),[$,K]=(0,s.useState)(-1),L=50,T=50;o&&(r?T+=50:L+=50);let[D,F]=(0,s.useState)(e);if(D!=e)return F(e),O(new f([...Array(w).keys()])),(0,x.jsx)(x.Fragment,{});let Y=k?.width||0,A=k?.height||0;(0,s.useLayoutEffect)((()=>{_(N.current?.getBoundingClientRect())}),[N]),"undefined"!=typeof window&&(0,i.A)(N,(t=>_(t.contentRect)));let M=new b(50,50,Y-L,A-T),R=new g(e,r,M),X=[];function z(t,e,r){let[s,o]=R.verticalitySwap(t,e);return s+=r?-15:15,R.verticalitySwap(s,o)}for(let t=0;t<R.rootSubnet.width;t++){let e=R.rootSubnet.isInput(t),r=R.rootSubnet.isTerminal(t),s=R.rootSubnet.isSubOutput(t)?h:a;for(let o=0;o<R.rootSubnet.height;o++){let[i,l]=R.toScreen(t,o);r&&([i,l]=z(i,l,e)),X.push((0,x.jsx)("circle",{cx:i,cy:l,stroke:"none",r:r?15:8,fill:s},t+","+o))}}function G(t,e,r,s,o,i){let l,n,a,h="";function c(r,s,o,i,l,n){let[a,h]=R.toScreen(s,o),[c,d]=R.toScreen(i,l);t.push((0,x.jsx)("line",{x1:a,y1:h,x2:c,y2:d,strokeOpacity:.5,stroke:n,strokeWidth:2},e+r))}i?(l=a=s,n=h=o):(l=h=s,n=a=o),c("t",r.left,r.top,r.right,r.top,l),c("b",r.left,r.bottom,r.right,r.bottom,n),c("f",r.left,r.top,r.right,r.bottom,a),c("r",r.left,r.bottom,r.right,r.top,h)}let P=[],J=[];!function t(e,r,s){if(1===s.order)G(e,s.id+"but",s.extent(),c,c,!1);else{let o=s.topSubnet(),i=s.bottomSubnet(),l=20,n=R.toScreenBox(o.extent()),a=R.toScreenBox(i.extent());n.pad(l),a.pad(l),r.push((0,x.jsx)("rect",{rx:10,ry:10,x:n.left,y:n.top,width:n.right-n.left,height:n.bottom-n.top,stroke:"none",fill:"url('#topGrad')",fillOpacity:.2},"br"+o.id)),r.push((0,x.jsx)("rect",{rx:10,ry:10,x:a.left,y:a.top,width:a.right-a.left,height:a.bottom-a.top,stroke:"none",fill:"url('#botGrad')",fillOpacity:.2},"br"+i.id)),t(e,r,o),t(e,r,i);for(let t=0;t<o.height;t++){let r=new b(0,0,0,0);r.top=o.globalY(t),r.bottom=i.globalY(t),r.left=s.extent().left,r.right=o.extent().left,G(e,s.id+"_butt_"+t+"_",r,d,u,!1),r.right=s.extent().right,r.left=o.extent().right,G(e,s.id+"_butb_"+t+"_",r,d,u,!0)}}}(P,J,R.rootSubnet);let V=[];!function(t,e,r){let s=2**r;var o,i=l.exT().domain([0,s-1]).interpolator((o=["#fa7970","#ecf2f8","#faa356","#7ce38b","#a2d2fb","#77bdfb","#cea5fb"],t=>l.$Bd(l.dJd,o)(Math.min(Math.max(0,t),1))));for(let r=0;r<s;r++){let s=i(r),o=e[r];for(let e=0;e<o.edgeColors.length;e++){let[i,l]=R.toScreen(e,o.verts[e]),[n,a]=R.toScreen(e+1,o.verts[e+1]),h=o.edgeColors[e],p=c;m?h===j.Top?p=d:h===j.Bottom&&(p=u):p=s.toString(),t.push((0,x.jsx)("line",{x1:i,y1:l,x2:n,y2:a,fill:"none",strokeWidth:"6",strokeDasharray:S?"10,30":"",stroke:p,children:S&&(0,x.jsx)("animate",{attributeName:"stroke-dashoffset",values:"40;0",dur:"3s",calcMode:"linear",repeatCount:"indefinite"})},`rt_${r}_${e}`))}}}(V,y(e,C),e);let W=[],E=[];!function(t){for(let e=0;e<R.rootSubnet.height;e++){let[r,s]=z(...R.toScreen(0,e),!0);t.push((0,x.jsx)("div",{className:"absolute pointer-events-none bold",style:{transform:`translate(-50%, -50%) translate(${r}px, ${s}px)`,color:n},children:(0,x.jsx)(p.KI,{children:`${e+1}`})},"il_"+e))}}(W),function(t,e){for(let s=0;s<R.rootSubnet.height;s++){let o=C.lut[s],[i,l]=z(...R.toScreen(R.rootSubnet.extent().right,o),!1);t.push((0,x.jsx)("div",{className:"absolute pointer-events-none",style:{transform:`translate(-50%, -50%) translate(${i}px, ${l}px)`,color:n},children:(0,x.jsx)(p.KI,{children:`${o+1}`})},"ol_"+s.toString()));let a=0===o?0:R.rootSubnet.height,h={opacity:I===a?1:0};h[r?"left":"top"]=(0===o?"-":"")+"10px";let c,d,u=(0,x.jsx)("div",{className:"relative w-0 h-0",children:(0,x.jsx)("div",{className:`absolute transition bg-cyan-400 shrink-0 ${r?"h-12":"w-12"} ${r?"w-0.5":"h-0.5"}`,style:h},`drop_${a}`)});function f(t,e){return{transform:r?`translate(-50%, 0) translate(${t}px, ${e+20}px)`:`translate(0, -50%) translate(${t+20}px, ${e}px)`,flexDirection:r?"row":"column"}}0===o?c=u:o===R.rootSubnet.height-1&&(d=u),e.push((0,x.jsxs)("div",{className:"absolute flex transition-transform duration-200",style:f(i,l),children:[c,(0,x.jsxs)("div",{className:"flex items-center bg-white/0 hover:bg-white/30 pushed:bg-white/50 transition rounded-sm cursor-grab p-1 active:cursor-grabbing",draggable:"true",onDragStart:t=>{K(o)},style:{flexDirection:r?"column":"row"},children:[(0,x.jsx)("div",{className:"px-1 "+(r?"-rotate-90":"rotate-180"),children:(0,x.jsx)(p.KI,{children:"\\mapsto"})}),(0,x.jsx)(p.KI,{children:`${s+1}`})]}),d]},"ob_"+s.toString())),o<R.rootSubnet.height-1&&([i,l]=z(...R.toScreen(R.rootSubnet.extent().right,o+.5),!1),a=o+1,t.push((0,x.jsx)("div",{"data-before":o,className:`absolute transition bg-cyan-400 shrink-0 ${r?"h-12":"w-12"} ${r?"w-0.5":"h-0.5"}`,style:{opacity:I===o+1?1:0,...f(i,l)}},`drop_${a}`)))}}(W,E),o&&W.push(...E);let H=(0,x.jsxs)("svg",{className:"absolute",width:Y,height:A,children:[(0,x.jsx)("filter",{id:"noiseFilter",children:(0,x.jsx)("feTurbulence",{type:"fractalNoise",baseFrequency:"3.76",numOctaves:"3",stitchTiles:"stitch"})}),(0,x.jsxs)("defs",{children:[(0,x.jsxs)("linearGradient",{id:"topGrad",x1:"10%",y1:"100%",x2:"90%",y2:"0%",children:[(0,x.jsx)("stop",{offset:"10%",stopColor:d,stopOpacity:.8}),(0,x.jsx)("stop",{offset:"90%",stopColor:d,stopOpacity:.2})]}),(0,x.jsxs)("linearGradient",{id:"botGrad",x1:"10%",y1:"100%",x2:"90%",y2:"0%",children:[(0,x.jsx)("stop",{offset:"10%",stopColor:u,stopOpacity:.8}),(0,x.jsx)("stop",{offset:"90%",stopColor:u,stopOpacity:.2})]})]}),v&&J,P,o&&V,(0,x.jsx)("g",{fill:"white",stroke:"currentColor",strokeWidth:"1.5",children:X})]});return(0,x.jsx)("div",{className:"flex items-stretch w-full h-full p-1",style:{background:n,flexDirection:r?"column":"row"},children:(0,x.jsx)("div",{className:"flex grow items-stretch p-1",children:(0,x.jsxs)("div",{ref:N,className:"relative flex grow p-0 m-0 overflow-hidden",onDragOver:function(t){let e=$,r=R.yFromScreen(t.clientX,t.clientY);t.preventDefault(),t.clientY,B(r<e?r:r>e?r+1:-1)},onDragLeave:()=>B(-1),onDrop:function(t){B(-1);let e=$,r=R.yFromScreen(t.clientX,t.clientY),s=[...C.invLut],o=s[e];s.splice(e,1),s.splice(r,0,o);let i=new f(s);i.invert(),O(i)},children:[H,W]})})})}var w=r(1925),N=r(1821),k=r(2349),_=(r(2222),r(3221),r(4433)),C=r(2927);function O(){let[t,e]=(0,s.useState)(3),[r,o]=(0,s.useState)(!0),[i,l]=(0,s.useState)(!1),[n,c]=(0,s.useState)(!0),[d,u]=(0,s.useState)(!1),[f,b]=(0,s.useState)(!1);return(0,x.jsxs)(w.O,{className:"h-dvh w-full",children:[(0,x.jsx)(w.K,{size:75,className:"overflow-hidden",children:(0,x.jsx)(S,{order:t,vertical:r,doRouting:i,drawBoxes:n,bipartiteColors:d,dottedLines:f})}),(0,x.jsx)(w.K,{size:25,className:"",children:(0,x.jsxs)("div",{className:"pl-7 pr-7 space-y-4 overflow-scroll",children:[(0,x.jsxs)("h1",{className:"text-xl font-bold my-4 font-italic",children:["Beneš ",i?"Routing":"Nets"]}),(0,x.jsxs)("p",{children:["This is an interactive demo of the so-called ",(0,x.jsx)("a",{target:"_blank",rel:"noopener noreferrer",className:"underline text-sky-300 hover:text-sky-200",href:"https://eng.libretexts.org/Bookshelves/Computer_Science/Programming_and_Computation_Fundamentals/Mathematics_for_Computer_Science_(Lehman_Leighton_and_Meyer)/02%3A_Structures/10%3A_Communication_Networks/10.09%3A_Benes_Network",children:"Beneš networks"}),"."]}),(0,x.jsxs)("p",{children:["They have ",(0,x.jsxs)("span",{style:{color:a},children:[(0,x.jsx)(p.KI,{children:"n"}),' "input nodes"']})," and ",(0,x.jsxs)("span",{style:{color:h},children:[(0,x.jsx)(p.KI,{children:"n"}),' "output nodes"']})," (indicated as big circles). In total, they have ",(0,x.jsx)(p.KI,{children:"2 n \\log n"})," nodes and a maximum degree of ",(0,x.jsx)(p.KI,{children:"4"}),"."]}),(0,x.jsxs)("p",{children:["They have a recursive structure, as indicated by the boxes. That is why ",(0,x.jsx)(p.KI,{children:"n=2^k"})," is a power of two. We refer to ",(0,x.jsx)(p.KI,{children:"k"})," as the order."]}),(0,x.jsxs)("div",{className:"text-sm",children:[(0,x.jsxs)("label",{className:"block mb-1 font-bold",htmlFor:"benesOrder",children:["Order ",(0,x.jsx)(p.KI,{children:"k"}),":"]}),(0,x.jsx)(N.Y,{className:"w-full",name:"benesOrder",value:t,onValueChange:t=>{let r=t.value;r&&!isNaN(r)&&e(r)},mode:"decimal",showButtons:!0,min:1,max:6})]}),(0,x.jsxs)("div",{className:"text-sm",children:[(0,x.jsx)("label",{className:"block mb-1 font-bold",htmlFor:"vertical",children:"Layout direction:"}),(0,x.jsx)(C.J,{className:"w-full",value:r?"Vertical":"Horizontal",onChange:t=>o("Vertical"==t.value),options:["Vertical","Horizontal"]})]}),(0,x.jsxs)("p",{children:["Beneš nets satisfy the following property: Any bijection ",(0,x.jsx)(p.KI,{children:"\\pi \\in S_n"})," from its ",(0,x.jsxs)("span",{style:{color:a},children:[(0,x.jsx)(p.KI,{children:"n"})," input nodes"]})," to its ",(0,x.jsxs)("span",{style:{color:h},children:[(0,x.jsx)(p.KI,{children:"n"})," output nodes"]})," can be realized by vertex-disjoint paths. Try it!"]}),(0,x.jsxs)("div",{className:"text-sm",children:[(0,x.jsx)("label",{className:"block mb-1 font-bold",htmlFor:"vertical",children:"Show routes:"}),(0,x.jsx)(_.H,{checked:i,onChange:t=>l(t.value)})]}),i&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("p",{children:["Click on any prescription arrow ",(0,x.jsx)(p.KI,{children:"\\mapsto"})," and drag it to configure the bijection ",(0,x.jsx)(p.KI,{children:"\\pi"}),"."]}),(0,x.jsxs)("div",{className:"text-sm",children:[(0,x.jsx)("label",{className:"block mb-1 font-bold",htmlFor:"vertical",children:"Path coloring:"}),(0,x.jsx)(C.J,{className:"w-full",value:d?"Bipartite":"Pathwise",onChange:t=>u("Bipartite"==t.value),options:["Bipartite","Pathwise"]})]}),(0,x.jsxs)("div",{className:"text-sm",children:[(0,x.jsx)("label",{className:"block mb-1 font-bold",htmlFor:"vertical",children:"Lines:"}),(0,x.jsx)(C.J,{className:"w-full",value:f?"Dotted":"Simple",onChange:t=>b("Dotted"==t.value),options:["Simple","Dotted"]})]})]})]})})]})}const I=o.createRoot(document.getElementById("root"));(0,p._)(),I.render((0,x.jsx)(s.StrictMode,{children:(0,x.jsx)(k.mD,{children:(0,x.jsx)(O,{})})}))}},r={};function s(t){var o=r[t];if(void 0!==o)return o.exports;var i=r[t]={exports:{}};return e[t](i,i.exports,s),i.exports}s.m=e,t=[],s.O=(e,r,o,i)=>{if(!r){var l=1/0;for(c=0;c<t.length;c++){for(var[r,o,i]=t[c],n=!0,a=0;a<r.length;a++)(!1&i||l>=i)&&Object.keys(s.O).every((t=>s.O[t](r[a])))?r.splice(a--,1):(n=!1,i<l&&(l=i));if(n){t.splice(c--,1);var h=o();void 0!==h&&(e=h)}}return e}i=i||0;for(var c=t.length;c>0&&t[c-1][2]>i;c--)t[c]=t[c-1];t[c]=[r,o,i]},s.d=(t,e)=>{for(var r in e)s.o(e,r)&&!s.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),s.j=222,(()=>{var t={222:0};s.O.j=e=>0===t[e];var e=(e,r)=>{var o,i,[l,n,a]=r,h=0;if(l.some((e=>0!==t[e]))){for(o in n)s.o(n,o)&&(s.m[o]=n[o]);if(a)var c=a(s)}for(e&&e(r);h<l.length;h++)i=l[h],s.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return s.O(c)},r=self.webpackChunkreact_ts_tailwind_starter=self.webpackChunkreact_ts_tailwind_starter||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))})();var o=s.O(void 0,[967,810,76],(()=>s(5012)));o=s.O(o)})();
//# sourceMappingURL=benes.5461d752f0ee8437fcd6.js.map